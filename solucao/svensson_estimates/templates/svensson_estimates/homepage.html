{% load static %}
<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Estimativas Svensson - ANBIMA</title>
    <link rel="stylesheet" href="{% static 'svensson_estimates/css/homepage.css' %}">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/contrib/auto-render.min.js"></script>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“Š Estimativas Svensson</h1>
            <p>EstimaÃ§Ã£o de parÃ¢metros do modelo Svensson - MÃ©todo ANBIMA</p>
        </div>

        <div class="nav-links">
            <a href="{% url 'rates:homepage' %}">â† Voltar para Taxas B3</a>
        </div>

        <div class="main-content">
            {% include 'svensson_estimates/partials/dates_sidebar.html' %}

            <div class="card chart-card">
                {% if rates_data %}
                    <div class="sections-container">
                        {% include 'svensson_estimates/partials/attempts_section.html' %}
                        {% include 'svensson_estimates/partials/error_metrics_section.html' %}
                    </div>

                    <div class="chart-controls">
                        <div class="chart-info">
                            ğŸ’¡ Arraste para selecionar Ã¡rea e dar zoom | Scroll para zoom rÃ¡pido | Ctrl+arraste para mover
                        </div>
                        <button id="toggleXAxisButton" class="btn-reset-zoom" onclick="toggleXAxis()">
                            Eixo X: Dias Corridos
                        </button>
                        <button class="btn-reset-zoom" onclick="resetZoom()">
                            ğŸ”„ Resetar Zoom
                        </button>
                    </div>
                    <div class="chart-container">
                        <canvas id="ratesChart"></canvas>
                    </div>
                {% else %}
                    <div class="empty-state">
                        <div class="empty-state-icon">ğŸ“ˆ</div>
                        <h3>Selecione uma data</h3>
                        <p>Escolha uma data da lista ao lado para visualizar os pontos da curva DI x PRÃ‰ 252</p>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>

    {% include 'svensson_estimates/partials/attempt_modal.html' %}

    <div id="svensson-page-data" data-selected-date="{% if selected_date %}{{ selected_date|date:'Y-m-d' }}{% endif %}"></div>
    {% if rates_series %}
    {{ rates_series|json_script:"svensson-rates-data" }}
    {% endif %}

    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/hammerjs@2.0.8"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom@2.0.1/dist/chartjs-plugin-zoom.min.js"></script>
    <script src="{% static 'svensson_estimates/js/homepage.js' %}"></script>
</body>
</html>
